<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>アイテム追加</title>
</head>
<body>
    <h1>アイテム追加</h1>
    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <button type="submit">保存</button>
    </form>
    <a href="{% url 'item_list' %}">戻る</a>
</body>
</html>




{% comment %} <!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <title>アイテム追加</title>
    <script>
        // 単価を計算してリアルタイムに結果を表示する
        function calculateUnitPrice(row) {
            const priceInput = row.querySelector('.price-input');
            const unitInput = row.querySelector('.unit-input');
            const resultField = row.querySelector('.unit-price-result');

            const price = parseInt(priceInput.value, 10) || 0;
            const unitQuantity = parseInt(unitInput.value, 10) || 0;

            if (unitQuantity > 0) {
                resultField.textContent = `価格: ${price}円　単価: ${(price / unitQuantity).toFixed(2)}円`;
            } else {
                resultField.textContent = '単価: -- 円';
            }
        }

        document.addEventListener('DOMContentLoaded', function() {
            const rows = document.querySelectorAll('.price-row');
            rows.forEach(row => {
                const priceInput = row.querySelector('.price-input');
                const unitInput = row.querySelector('.unit-input');

                priceInput.addEventListener('input', () => calculateUnitPrice(row));
                unitInput.addEventListener('input', () => calculateUnitPrice(row));
            });
        });
    </script>
</head>
<body>
    <h1>アイテム追加</h1>

    <!-- エラーメッセージを表示 -->
    {% if form.errors %}
    <div class="error-messages">
        <ul>
            {% for field in form %}
                {% for error in field.errors %}
                    <li>{{ error }}</li>
                {% endfor %}
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    {% if formset.errors %}
    <div class="error-messages">
        <ul>
            {% for form in formset %}
                {% for error in form.errors %}
                    <li>{{ error }}</li>
                {% endfor %}
            {% endfor %}
        </ul>
    </div>
    {% endif %}

    <form method="post">
        {% csrf_token %}
        {{ form.as_p }}
        <h2>店舗ごとの価格情報</h2>
        <table>
            <thead>
                <tr>
                    <th>店舗名</th>
                    <th>価格</th>
                    <th>入数</th>
                    <th>単価計算結果</th>
                    <th>メモ</th>
                </tr>
            </thead>
            <tbody>
                {% for form in formset %}
                <tr class="price-row">
                    <td>{{ form.store }}</td>  <!-- 店舗のフォームを表示 -->
                    <td><input type="number" class="price-input" name="price_{{ forloop.counter }}" value="{{ form.price.value }}" step="1"></td>  <!-- 価格のフォーム -->
                    <td><input type="number" class="unit-input" name="unit_quantity_{{ forloop.counter }}" value="{{ form.unit_quantity.value }}" step="1"></td>  <!-- 入数のフォーム -->
                    <td class="unit-price-result">単価: -- 円</td>  <!-- 単価計算結果 -->
                    <td>{{ form.memo }}</td>  <!-- メモのフォーム -->
                </tr>
                {% endfor %}
            </tbody>
        </table>
        <button type="submit">保存</button>
    </form>
</body>
</html>
 {% endcomment %}
