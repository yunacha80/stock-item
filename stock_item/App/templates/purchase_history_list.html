<!DOCTYPE html>
<html lang="ja">
{% extends "base.html" %}
{% block head %}
<head>
    <meta charset="UTF-8">
    <title>è³¼å…¥å±¥æ­´</title>
    
</head>
{% endblock head %}
{% block content %}
<body class="purchase-history-page">
    <h1>è³¼å…¥å±¥æ­´</h1>

    <!-- æ¤œç´¢ãƒ•ã‚©ãƒ¼ãƒ  -->
    <form method="get" action="{% url 'purchase_history_Search' %}">
        <div class="purchase-form-group">
            <label for="item-selection">ã‚¢ã‚¤ãƒ†ãƒ ã‚’é¸æŠ:</label>
            <div class="item-list">
                {% for field in form.fields.items.queryset %}
                    <div class="item-checkbox">
                        <input type="checkbox" name="items" value="{{ field.id }}" id="item-{{ field.id }}">
                        <label for="item-{{ field.id }}">{{ field.name }}- {{ field.category.name }}</label>
                    </div>
                {% endfor %}
            </div>
        </div>
        <button type="submit" class="search-button">æ¤œç´¢</button>
    </form>

    <h2>æ¤œç´¢çµæœ</h2>
    {% if grouped_histories %}
        <div class="suggestions">
            {% for date, histories in grouped_histories.items %}
                <details class="suggestion-details">
                    <summary>
                        <span class="suggestion-icon">ğŸ”½</span> {{ date }} - {{ histories|length }} ä»¶</summary>
                    <ul>
                        {% for history in histories %}
                            <li>
                                ã‚¢ã‚¤ãƒ†ãƒ åï¼š {{ history.item.name }}-{{ history.item.category.name }}<br>
                                è³¼å…¥æ•°é‡ï¼š {{ history.purchased_quantity }}
                            </li>
                        {% endfor %}
                    </ul>
                </details>
            {% endfor %}
        </div>
    {% else %}
        <p>è©²å½“ã™ã‚‹è³¼å…¥å±¥æ­´ãŒã‚ã‚Šã¾ã›ã‚“ã€‚</p>
    {% endif %}
    <br><br><br>
</body>
{% endblock %}
</html>
